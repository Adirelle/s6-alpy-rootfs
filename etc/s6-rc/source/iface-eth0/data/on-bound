#!/bin/execlineb -P

import -ui interface

if {
	import -ui ip
	foreground { echo "Address: ${ip}" }
	ifconfig ${interface} ${ip}
}

foreground {
	import -ui subnet
	foreground { echo "Netmask: ${subnet}" }
	ifconfig ${interface} netmask ${subnet}
}

foreground {
	import -ui broadcast
	foreground { echo "Broadcast: ${broadcast}" }
	ifconfig ${interface} broadcast ${broadcast}
}

foreground {
	import -ui router
	foreground { ./clear-routes 0.0.0.0 }
	foreground { echo "Router: ${router}" }
	ip route add default via ${router} dev ${interface} metric 1024
}

foreground {
	import -uis dns
	foreground { echo "Nameservers: $dns" }
	redirfd -w 1 /etc/resolv.conf
	echo "nameserver ${dns}\n"
}

exit 0
